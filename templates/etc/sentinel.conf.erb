# redis sentinel server conf

# !!! generated by puppet !!!

daemonize yes

pidfile <%= @sentinel_pid_dir %>/redis-sentinel_<%= @sentinel_name %>.pid

logfile <%= @sentinel_log_dir -%>/redis-sentinel_<%= @sentinel_name %>.log

port <%= @sentinel_port -%>

<%
  #rules = scope.lookupvar('redis::sentinel::monitors')
  @monitors.sort.each do |name, rule| %>
# monitor <%= name %>
sentinel monitor <%= name -%> <%= rule['master_host'] -%>  <%= rule['master_port'] -%> <%= rule['quorum'] %>
sentinel down-after-milliseconds <%= name -%> <%= rule['down_after_milliseconds'] %>
sentinel parallel-syncs <%= name -%> <%= rule['parallel-syncs'] %>
sentinel failover-timeout <%= name -%> <%= rule['failover_timeout'] %>
<%- if rule['auth-pass'] then %>sentinel auth-pass <%= name -%> <%= rule['auth-pass'] %><% end %>
<%- if rule['notification-script'] then %>sentinel notification-script <%= name -%> <%= rule['notification-script'] %><% end %>
<%- if rule['client-reconfig-script'] then %>sentinel client-reconfig-script <%= name -%> <%= rule['client-reconfig-script'] %><% end %>

<% end %>
